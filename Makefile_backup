CC=g++
CFLAGS=-Wall -std=c++17 -O3 -funroll-loops -DASIO_STANDALONE

INCLUDES=-Iinclude #-I/opt/homebrew/opt/openssl@1.1/include/
#LIBPATH=-L/opt/homebrew/opt/openssl@1.1/lib/
#LIBS=-lcrypto -lssl

# g++ -Wall -std=c++17 -O3 -funroll-loops -DASIO_STANDALONE -Iinclude -I/home/hackear/anaconda3/include/python3.9/ -lpython3.9 src/bindings.cpp src/board.cpp src/engine.cpp -o rollerball.so -shared -fPIC

# g++ -Wall -std=c++17 -O3 -funroll-loops -DASIO_STANDALONE -Iinclude -I/home/hackear/anaconda3/include/python3.9/ -lpython3.9 src/server.cpp src/board.cpp src/engine.cpp src/rollerball.cpp src/uciws.cpp -o bin/rollerball -L 


# g++ -Wall -std=c++17 -O3 -funroll-loops -DASIO_STANDALONE -Iinclude -I/home/hackear2041/anaconda src/server.cpp src/board.cpp src/engine.cpp src/rollerball.cpp src/uciws.cpp -o bin/rollerball -lpython3.10

# g++ -Wall -std=c++17 -O3 -funroll-loops -DASIO_STANDALONE -Iinclude  src/server.cpp src/board.cpp src/engine.cpp src/rollerball.cpp src/uciws.cpp -o bin/rollerball

# g++ -O3 -Wall -shared -std=c++17 -fPIC `python3 -m pybind11 --includes` bindings.cpp -o board`python3-config --extension-suffix`

# g++ -Wall -std=c++17 -O3 -funroll-loops -DASIO_STANDALONE -Iinclude -I/usr/include/python3.10 src/server.cpp src/board.cpp src/engine.cpp src/rollerball.cpp src/uciws.cpp -o bin/rollerball -lpython3.10

# export PYTHONPATH="${PYTHONPATH}:/home/hackear/col333-rollerball/src/"
# export LD_LIBRARY_PATH=/home/hackear/anaconda3/lib:$LD_LIBRARY_PATH
# export LIBRARY_PATH=/home/hackear/anaconda3/lib:$LIBRARY_PATH
# g++ -Wall -std=c++17 -O3 -funroll-loops -DASIO_STANDALONE -Iinclude -I/home/hackear/anaconda3/include/python3.9/ src/server.cpp src/board.cpp src/engine.cpp src/rollerball.cpp src/uciws.cpp -o bin/rollerball -lpython3.9 -fPIC

############ FINAL SET OF COMMANDS ############
PYTHON_INCLUDEPATH=$(python -c "import sysconfig; print(sysconfig.get_path('include'))")
LIBRARY_PATH=$(python -c "import sysconfig; print(sysconfig.get_path('platlib'))")
PYTHON_VERSION=$(python -c "import sys; print('python' + sys.version[:3])")
export LIBRARY_PATH=$LIBRARY_PATH:$LIBRARY_PATH

# echo $(PYTHON_INCLUDEPATH)

# g++ -Wall -std=c++17 -O3 -funroll-loops -DASIO_STANDALONE -Iinclude -I$INCLUDE_PATH src/server.cpp src/board.cpp src/engine.cpp src/rollerball.cpp src/uciws.cpp -o bin/rollerball -l$PYTHON_VERSION -fPIC

# export LIBRARY_PATH=$LIBRARY_PATH:$LIBRARY_PATH
# g++ -Wall -std=c++17 -O3 -funroll-loops -DASIO_STANDALONE -Iinclude -I$INCLUDE_PATH src/server.cpp src/board.cpp src/engine.cpp src/rollerball.cpp src/uciws.cpp -o bin/rollerball -l$PYTHON_VERSION -fPIC

# PYTHON_INCLUDE_PATH=$(python -c "import sysconfig; print(sysconfig.get_path('include'))")
# LIBRARY_PATH=$(python -c "import sysconfig; print(sysconfig.get_path('platlib'))")
# PYTHON_VERSION=$(python -c "import sys; print('python' + sys.version[:3])")
# export LIBRARY_PATH=$(LIB_PATH):$LIBRARY_PATH
# export LIBRARY_PATH=$LIBRARY_PATH:$LIBRARY_PATH
# -l$PYTHON_VERSION -fPIC
rollerball:
	$(CC) $(CFLAGS) $(INCLUDES) src/server.cpp src/board.cpp src/engine.cpp src/rollerball.cpp src/uciws.cpp -o bin/rollerball
rollerball_py:
	$(CC) $(CFLAGS) $(INCLUDES) src/server.cpp src/board.cpp src/engine_py.cpp src/rollerball.cpp src/uciws.cpp -o bin/rollerball -I$(PYTHONINCLUDEPATH) -l$(PYTHONVERSION) -fPIC
lib:
	$(CC) $(CFLAGS) $(INCLUDES) -shared src/board.cpp -o bin/librollerball.so

dbg_frontend: src/debug_frontend.cpp 
	$(CC) $(CFLAGS) $(INCLUDES) src/server.cpp src/debug_frontend.cpp -o bin/debug_frontend

dbg_uciws: src/debug_uciws.cpp 
	$(CC) $(CFLAGS) $(INCLUDES) src/server.cpp src/uciws.cpp src/debug_uciws.cpp -o bin/debug_uciws

dbg_board: src/debug_board.cpp 
	$(CC) $(CFLAGS) $(INCLUDES) src/board.cpp src/debug_board.cpp -o bin/debug_board

all: server client

server: src/server.cpp
	$(CC) $(CFLAGS) $(INCLUDES) $< -o bin/server

client: src/client.cpp
	$(CC) $(CFLAGS) $(INCLUDES) $< -o bin/client

clean:
	rm bin/*
